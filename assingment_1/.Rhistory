# Multiple Linear Regression
head(Boston) # In library ISLR2 -- ?Boston
library(rgl)
library(ISLR2)
# Multiple Linear Regression
head(Boston) # In library ISLR2 -- ?Boston
str(Boston)
colnames(Boston)
lm.fit <- lm(medv ~ lstat + age , data = Boston)
names(lm.fit)  # What's in lm.fit?
lm.fit$coefficients # Extract coefficients (approach 1)
coef(lm.fit)   # Extract coefficients (approach 2)
coef(lm.fit)[2]
summary(lm.fit) #
names(summary(lm.fit)) # What's in Summary?
summary(lm.fit)$sigma
# R documentation summary?
?summary.lm
# How do I fit a model without intercept?
lm.fit <- lm(medv ~ -1 +lstat + age , data = Boston)
summary(lm.fit)
# Confidence intervals for the coefficients
confint(lm.fit)
# Simple prediction
medv_hat = predict(lm.fit) # Prediction for data in training set
# Predictions for new observations
predict(lm.fit, data.frame(lstat = c(5, 10, 15), age = c(30,50,70)))
# Plots for linear models: lm medv ~ lstat
lm.fit1 = lm(medv ~ lstat, data = Boston)
ggplot()+
geom_point(aes(x = Boston$lstat, y = Boston$medv), size = 2)+
geom_abline(slope = lm.fit1$coefficients[2], intercept = lm.fit1$coefficients[1], col = 'red')
# Plots for linear models by generating many "new observations"
new_obs = data.frame(lstat = seq(from = 0, to = 40, by = 1), age = 40)
pred = predict(lm.fit1, new_obs)
ggplot()+
geom_point(aes(x = Boston$lstat, y = Boston$medv))+
geom_line(mapping=aes(x = new_obs$lstat, y=pred), size=1, col='red')
# model with all covariates
lm.fit <- lm(medv ~ ., data = Boston)
summary (lm.fit)
# model with all but one covariate
lm.fit1 <- lm(medv ~ . - age , data = Boston)
summary(lm.fit1)
# Model with interaction
lm.fit_int = lm(medv ~ lstat + age + lstat:age , data = Boston)
summary(lm.fit_int)
lm.fit$coefficients # Extract coefficients (approach 1)
